CREATE DATABASE workou_planner;

use workou_planner;

CREATE TABLE users (
    user_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    email VARCHAR(150) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    goal VARCHAR(100),
    experience_level VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE workout_plan (
    plan_id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    goal_type VARCHAR(100),
    difficulty VARCHAR(50),
    duration_weeks INT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    FOREIGN KEY (user_id) REFERENCES users(user_id)
        ON DELETE CASCADE
);

CREATE TABLE exercise (
    exercise_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    description TEXT,
    difficulty_level VARCHAR(50),
    video_url VARCHAR(255),
    calories_per_minute DECIMAL(5,2)
);

CREATE TABLE plan_exercise (
    plan_exercise_id INT AUTO_INCREMENT PRIMARY KEY,
    plan_id INT NOT NULL,
    exercise_id INT NOT NULL,
    sets INT,
    reps INT,
    duration_minutes INT,
    
    FOREIGN KEY (plan_id) REFERENCES workout_plan(plan_id)
        ON DELETE CASCADE,
        
    FOREIGN KEY (exercise_id) REFERENCES exercise(exercise_id)
        ON DELETE CASCADE
);


CREATE TABLE progress (
    progress_id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    date DATE,
    calories_burned DECIMAL(6,2),
    weight DECIMAL(5,2),
    workout_completed BOOLEAN,
    
    FOREIGN KEY (user_id) REFERENCES users(user_id)
        ON DELETE CASCADE
);

CREATE TABLE schedule (
    schedule_id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    plan_id INT NOT NULL,
    workout_date DATE,
    status VARCHAR(50),
    
    FOREIGN KEY (user_id) REFERENCES users(user_id)
        ON DELETE CASCADE,
        
    FOREIGN KEY (plan_id) REFERENCES workout_plan(plan_id)
        ON DELETE CASCADE
);

CREATE TABLE challenge (
    challenge_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(150) NOT NULL,
    description TEXT,
    start_date DATE,
    end_date DATE,
    reward VARCHAR(100)
);

CREATE TABLE challenge_participation (
    participation_id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    challenge_id INT NOT NULL,
    score INT,
    rankposition INT,
    
    FOREIGN KEY (user_id) REFERENCES users(user_id)
        ON DELETE CASCADE,
        
    FOREIGN KEY (challenge_id) REFERENCES challenge(challenge_id)
        ON DELETE CASCADE
);